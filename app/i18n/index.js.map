{"version":3,"file":"index.js","sources":["src/i18n/index.js"],"sourcesContent":["import path from 'path';\r\nimport fs from 'fs';\r\nimport util from 'util';\r\nimport { app, remote } from 'electron';\r\n\r\nconst eApp = app || remote.app;\r\n\r\nlet loadedLanguage = [];\r\n\r\n/**\r\n * Load singular and plural translation based on count\r\n * @param {string} phrase The key fore the translation string\r\n * @param {number} chount Count to check for singular / plural (0-1,2-n)\r\n * @returns {string} Translation in user language\r\n */\r\nfunction loadTranslation(phrase = '', count) {\r\n\tconst loadedLanguageTranslation = loadedLanguage[phrase];\r\n\tlet translation = loadedLanguageTranslation;\r\n\tif (loadedLanguageTranslation === undefined) {\r\n\t\ttranslation = phrase;\r\n\t} else if (loadedLanguageTranslation instanceof Object) {\r\n\t\ttranslation = loadedLanguageTranslation.zero;\r\n\t\tif (count === 1) {\r\n\t\t\ttranslation = loadedLanguageTranslation.one;\r\n\t\t} else if (count > 1) {\r\n\t\t\ttranslation = loadedLanguageTranslation.multi;\r\n\t\t}\r\n\t}\r\n\treturn translation;\r\n}\r\n\r\nclass I18n {\r\n\t/**\r\n     * Load users language if available, and fallback to english for any missing strings\r\n     * @constructor\r\n     */\r\n\tconstructor() {\r\n\t\tconst load = () => {\r\n\t\t\tlet dir = path.join(__dirname, '../i18n/lang');\r\n\t\t\tif (!fs.existsSync(dir)) {\r\n\t\t\t\tdir = path.join(__dirname, 'i18n/lang');\r\n\t\t\t}\r\n\t\t\tconst defaultLocale = path.join(dir, 'en.i18n.json');\r\n\t\t\tloadedLanguage = JSON.parse(fs.readFileSync(defaultLocale, 'utf8'));\r\n\t\t\tconst locale = path.join(dir, `${ eApp.getLocale() }.i18n.json`);\r\n\t\t\tif (fs.existsSync(locale)) {\r\n\t\t\t\tconst lang = JSON.parse(fs.readFileSync(locale, 'utf8'));\r\n\t\t\t\tloadedLanguage = Object.assign(loadedLanguage, lang);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (eApp.isReady()) {\r\n\t\t\tload();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\teApp.once('ready', load);\r\n\t}\r\n\r\n\t/**\r\n     * Get translation string\r\n     * @param {string} phrase The key for the translation string\r\n     * @param {...string|number} replacements List of replacements in template strings\r\n     * @return {string} Translation in users language\r\n     */\r\n\t__(phrase, ...replacements) {\r\n\t\tconst translation = loadTranslation(phrase, 0);\r\n\t\treturn util.format(translation, ...replacements);\r\n\t}\r\n\r\n\t/**\r\n     * Get translation string\r\n     * @param {string} phrase The key for the translation string\r\n     * @param {number} count Count to check for singular / plural (0-1,2-n)\r\n     * @param {...string|number} replacements List of replacements in template strings\r\n     * @return {string} Translation in users language\r\n     */\r\n\tpluralize(phrase, count, ...replacements) {\r\n\t\tconst translation = loadTranslation(phrase, count);\r\n\t\tif (translation.includes('%s')) {\r\n\t\t\treturn util.format(translation, ...replacements);\r\n\t\t}\r\n\t\treturn translation;\r\n\t}\r\n}\r\n\r\nexport default new I18n();\r\n"],"names":["app","remote"],"mappings":";;;;;;;;;;;AAKA,MAAM,IAAI,GAAGA,YAAG,IAAIC,eAAM,CAAC,GAAG,CAAC;;AAE/B,IAAI,cAAc,GAAG,EAAE,CAAC;;;;;;;;AAQxB,SAAS,eAAe,CAAC,MAAM,GAAG,EAAE,EAAE,KAAK,EAAE;CAC5C,MAAM,yBAAyB,GAAG,cAAc,CAAC,MAAM,CAAC,CAAC;CACzD,IAAI,WAAW,GAAG,yBAAyB,CAAC;CAC5C,IAAI,yBAAyB,KAAK,SAAS,EAAE;EAC5C,WAAW,GAAG,MAAM,CAAC;EACrB,MAAM,IAAI,yBAAyB,YAAY,MAAM,EAAE;EACvD,WAAW,GAAG,yBAAyB,CAAC,IAAI,CAAC;EAC7C,IAAI,KAAK,KAAK,CAAC,EAAE;GAChB,WAAW,GAAG,yBAAyB,CAAC,GAAG,CAAC;GAC5C,MAAM,IAAI,KAAK,GAAG,CAAC,EAAE;GACrB,WAAW,GAAG,yBAAyB,CAAC,KAAK,CAAC;GAC9C;EACD;CACD,OAAO,WAAW,CAAC;CACnB;;AAED,MAAM,IAAI,CAAC;;;;;CAKV,WAAW,GAAG;EACb,MAAM,IAAI,GAAG,MAAM;GAClB,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,cAAc,CAAC,CAAC;GAC/C,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;IACxB,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;IACxC;GACD,MAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;GACrD,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC,CAAC;GACpE,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,UAAU,CAAC,CAAC,CAAC;GACjE,IAAI,EAAE,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;IAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;IACzD,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;IACrD;GACD,CAAC;;EAEF,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;GACnB,IAAI,EAAE,CAAC;GACP,OAAO;GACP;;EAED,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;EACzB;;;;;;;;CAQD,EAAE,CAAC,MAAM,EAAE,GAAG,YAAY,EAAE;EAC3B,MAAM,WAAW,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;EAC/C,OAAO,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,GAAG,YAAY,CAAC,CAAC;EACjD;;;;;;;;;CASD,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE,GAAG,YAAY,EAAE;EACzC,MAAM,WAAW,GAAG,eAAe,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;EACnD,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;GAC/B,OAAO,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,GAAG,YAAY,CAAC,CAAC;GACjD;EACD,OAAO,WAAW,CAAC;EACnB;CACD;;AAED,YAAe,IAAI,IAAI,EAAE,CAAC;;;;;;;;"}